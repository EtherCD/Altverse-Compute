syntax = "proto3";

package game;

message PackedEntity {
  uint32 type_id = 1;
  int32 x = 2;
  int32 y = 3;
  uint32 radius = 4;
  bool harmless = 5;
  uint32 state = 7;
  uint32 state_metadata = 8;
  uint32 alpha = 9;
}

message PackedPlayer {
  string name = 1;
  uint32 id = 2;
  int32 x = 3;
  int32 y = 4;
  uint32 radius = 5;
  uint32 speed = 6;
  uint32 energy = 7;
  uint32 max_energy = 8;
  uint32 death_timer = 9;
  uint32 state = 10;
  uint32 state_meta = 11;
  uint32 area = 12;
  string world = 13;
  bool died = 14;
}

message PartialEntity {
  optional uint32 type_id = 1;
  optional int32 x = 2;
  optional int32 y = 3;
  optional uint32 radius = 4;
  optional bool harmless = 5;
  optional uint32 state = 7;
  optional uint32 state_metadata = 8;
  optional uint32 alpha = 9;
}

message PartialPlayer {
  optional string name = 1;
  optional uint32 id = 2;
  optional int32 x = 3;
  optional int32 y = 4;
  optional uint32 radius = 5;
  optional uint32 speed = 6;
  optional uint32 energy = 7;
  optional uint32 max_energy = 8;
  optional uint32 death_timer = 9;
  optional uint32 state = 10;
  optional uint32 state_meta = 11;
  optional uint32 area = 12;
  optional string world = 13;
  optional bool died = 14;
}


message PackedArea {
  float w = 1;
  float h = 2;
  uint64 area = 3;
  string world = 4;
  map<uint64, PackedEntity> entities = 5;
}

message Package {
  oneof kind {
    PackedPlayer new_player = 1;
    int64 close_player = 2;
    Players players = 3;
    Entities new_entities = 4;
    CloseEntities close_entities = 5;
    PackedArea area_init = 6;
    PackedPlayer myself = 7;
    UpdateEntitiesMap update_entities = 8;
    UpdatePlayersMap update_players = 9;
  }
}

message Packages {
  repeated Package items = 1;
}

message Players {
  map<int64, PackedPlayer> players = 1;
}

message Entities {
  map<int64, PackedEntity> entities = 1;
}

message CloseEntities {
  repeated int64 ids = 1;
}

message UpdateEntitiesMap {
  map<int64, PartialEntity> items = 1;
}

message UpdatePlayersMap {
  map<int64, PartialPlayer> items = 1;
}

